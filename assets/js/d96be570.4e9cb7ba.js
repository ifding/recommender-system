"use strict";(self.webpackChunkrecommender_system=self.webpackChunkrecommender_system||[]).push([[81],{1183:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>m,frontMatter:()=>o,metadata:()=>d,toc:()=>c});var i=s(4848),t=s(8453);const o={sidebar_position:2},r="Deep Learning Recommendation Models (DLRM)",d={id:"basics/DLRM",title:"Deep Learning Recommendation Models (DLRM)",description:"Paper link//arxiv.org/abs/1906.00091",source:"@site/docs/basics/DLRM.md",sourceDirName:"basics",slug:"/basics/DLRM",permalink:"/recommender-system/docs/basics/DLRM",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/basics/DLRM.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Basics",permalink:"/recommender-system/docs/category/basics"},next:{title:"Instagram Explore",permalink:"/recommender-system/docs/basics/Instagram"}},a={},c=[{value:"Issues",id:"issues",level:2},{value:"1. Memory Capacity Dominated",id:"1-memory-capacity-dominated",level:3},{value:"2. Memory Band-Width Dominated",id:"2-memory-band-width-dominated",level:3},{value:"3. Communication Based",id:"3-communication-based",level:3},{value:"4. Compute Dominated",id:"4-compute-dominated",level:3}];function l(e){const n={a:"a",blockquote:"blockquote",em:"em",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"deep-learning-recommendation-models-dlrm",children:"Deep Learning Recommendation Models (DLRM)"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["Paper link: ",(0,i.jsx)(n.a,{href:"https://arxiv.org/abs/1906.00091",children:"https://arxiv.org/abs/1906.00091"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Model workflow:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:s(6824).A+"",width:"900",height:"506"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["Source from: ",(0,i.jsx)(n.a,{href:"https://medium.com/swlh/deep-learning-recommendation-models-dlrm-a-deep-dive-f38a95f47c2c",children:"https://medium.com/swlh/deep-learning-recommendation-models-dlrm-a-deep-dive-f38a95f47c2c"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"All configurable parameters are outlined in blue, and the operators used are shown in Green."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:s(8968).A+"",width:"646",height:"296"})}),"\n",(0,i.jsx)(n.h2,{id:"issues",children:"Issues"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:s(6072).A+"",width:"659",height:"318"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Memory Capacity Dominated (Input from Network)"}),"\n",(0,i.jsx)(n.li,{children:"Memory Band-Width Dominated (Processing of Features: Embedding Lookup and MLP)"}),"\n",(0,i.jsx)(n.li,{children:"Communication Based (Interaction between Features)"}),"\n",(0,i.jsx)(n.li,{children:"Compute Dominated (Compute/Run-Time Bottleneck)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"1-memory-capacity-dominated",children:"1. Memory Capacity Dominated"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Embeddings contribute the majority of parameters, with several tables each requiring excess of multiple GBs of memory. This necessitates Distribution of moels across Multiple Devices."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Data Parallelism is preferred for MLPs since this enables conurrent processing of samples on different devices and only requires communication when accumulating updates."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"2-memory-band-width-dominated",children:"2. Memory Band-Width Dominated"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Embedding Lookups can cause memory constraints."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Quotient-Remainder Trick"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Using 2 complementary functions i.e. integer quotient and remainder functions: we can produce 2 separate embedding tables and combine them in a way that yields a unique embedding for each category."}),"\n",(0,i.jsx)(n.h3,{id:"3-communication-based",children:"3. Communication Based"}),"\n",(0,i.jsxs)(n.p,{children:["DLRM uses ",(0,i.jsx)(n.strong,{children:"model parallelism"})," to avoid replicating the whole set of embedding tables on every GPU device and ",(0,i.jsx)(n.strong,{children:"data parallelism"})," to enable concurrent processing of samples in FC layers."]}),"\n",(0,i.jsx)(n.p,{children:"MLP parameters are replicated across GPU devices and not shuffled."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"What is the problem?"})}),"\n",(0,i.jsx)(n.p,{children:"Transferring embedding tables across nodes in a cluster becomes expensive and could be a Bottleneck."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Solution"})}),"\n",(0,i.jsx)(n.p,{children:"Since it's the interaction between pairs of learned embedding vectors that matters and not the absolute values of embedding themselves."}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"We hypothesize we can learn embeddings in different nodes independently to result in a good model."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Saves Network Bandwidth by synchronizing only MLP parameters and learning Embedding tables independently on each of the server nodes."}),"\n",(0,i.jsx)(n.h3,{id:"4-compute-dominated",children:"4. Compute Dominated"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"MLP also results in Compute Overload"}),"\n",(0,i.jsx)(n.li,{children:"Co-location creates performance bottlenecks when running production-scale recommendation models leading to lower resource utilization"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Solution: FBGEMM"})]})}function m(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8968:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/dlrm_arch-23a550c1b4d40ddf093a1e65b4917ed9.png"},6072:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/dlrm_issues-ad358f910d6b0257ec6c882eb54041ef.png"},6824:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/dlrm_workflow-da0b9849623f4ef31fd71819327f57b7.gif"},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>d});var i=s(6540);const t={},o=i.createContext(t);function r(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);